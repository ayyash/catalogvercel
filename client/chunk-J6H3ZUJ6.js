import{A as C,Ya as v,a as g,e as p,g as m,i as l,n as u,p as h,sb as I,vb as n,w as f,xb as y,z as s}from"./chunk-2RYABZQO.js";var A=()=>C(o).loadAppConfig(),o=class i{constructor(e,t){this.http=e;this.localConfig=t;_seqlog("ConfigService")}_getUrl=n.API.config.local;config=new p(n);config$=this.config.asObservable();static _config;static get Config(){return this._config||n}NewInstance(e,t){let r=g(g({},n),e);return r.Cache=g({},r.Cache),r.isServed=!0,r.withErrors=t,i._config=r,this.config.next(r),r}loadAppConfig(){return _seqlog("LoadAppConfig"),this.localConfig?(this.NewInstance(this.localConfig,!0),m(!0)):this.http.get(this._getUrl).pipe(l(e=>(this.NewInstance(e,!1),_seqlog("config next"),!0)),u(e=>(this.NewInstance(n,!0),_debug(e,"Error in resolve","e"),m(!0))))}static \u0275fac=function(t){return new(t||i)(s(v),s("localConfig",8))};static \u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"})};var S=class i{constructor(e){this.configService=e;this._setResetKey()}get ourStorage(){return localStorage}getKey(e,t=!1){return`${o.Config.Cache.Key}${t?"."+y.language:""}.${e}`}_setResetKey(){this.configService.config$.pipe(h(e=>e.isServed),I("config")).subscribe(e=>{let t=this.getKey(e.Cache.ResetKey),r=this.ourStorage.getItem(t);(!r||r!=="true")&&(this.clear(),this.ourStorage.setItem(t,"true"))})}setItem(e,t,r=o.Config.Cache.Timeout,c=!1){let a={value:t,timestamp:Date.now(),expiresin:r};this.ourStorage.setItem(this.getKey(e,c),JSON.stringify(a))}getItem(e,t=!1){let r=this.getKey(e,t),c=this.ourStorage.getItem(r);if(c){let a=JSON.parse(c);return Date.now()-a.timestamp>a.expiresin*36e5?(this.removeItem(r),null):a.value}return null}removeItem(e,t=!1){this.ourStorage.removeItem(this.getKey(e,t))}setCache(e,t,r=o.Config.Cache.Timeout){this.setItem(e,t,r,!0)}getCache(e){return this.getItem(e,!0)}removeCache(e){this.removeItem(e,!0)}clear(){let e=[];for(let t=0;t<this.ourStorage.length;t++){let r=this.ourStorage.key(t);r?.indexOf(o.Config.Cache.Key)===0&&e.push(r)}e.forEach(t=>this.ourStorage.removeItem(t))}static \u0275fac=function(t){return new(t||i)(s(o))};static \u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"})};export{A as a,o as b,S as c};
