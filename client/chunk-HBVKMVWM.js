import{a as rt,b as lt,e as C}from"./chunk-EZ3FCO5Y.js";import{$ as N,Aa as X,Ba as Y,D as M,E as L,G,Ga as S,H as q,Ha as E,N as K,O as s,Oa as A,Q as I,Qa as Z,R as h,Ra as tt,Sa as et,Ta as it,Ua as b,W as _,Ya as O,Z as W,a as B,b as F,da as w,e as $,gb as ot,ha as l,hb as nt,i as d,ia as a,ja as H,ma as U,na as p,oa as P,ob as V,pa as z,pb as at,qa as J,sa as Q,vb as f,w as g,xa as r,ya as m,z as v,za as y}from"./chunk-2RYABZQO.js";var j=class i{constructor(e){this.router=e}data;dialog;ngOnInit(){}route(){this.router.navigateByUrl("/profiles/"+this.data.id),this.dialog.close()}static \u0275fac=function(t){return new(t||i)(I(ot))};static \u0275cmp=h({type:i,selectors:[["cl-profile-card-dialog"]],decls:13,vars:1,consts:[[1,"grid","g-1"],[1,"f4","spaced","weight-normal","a",3,"click"],[1,"breath"]],template:function(t,o){t&1&&(l(0,"div",0)(1,"div"),r(2,"profile"),a(),l(3,"div")(4,"h5",1),p("click",function(){return o.route()}),r(5),a(),r(6," email@address.com "),H(7,"br"),r(8," +293998383838 "),H(9,"br"),l(10,"p",2),r(11," Lorem ipsum dolor sit amet consectetur, adipisicing elit. Nisi dolorum dicta atque ipsum "),a(),r(12," 3 ideas . 1 active "),a()()),t&2&&(s(5),m(o.data.name))},dependencies:[b,V],encapsulation:2,changeDetection:0})};var ut=["*"],k=class i{onClose=new q;options;close(e){this.onClose.emit(e)}onClick(e){e.matches(".d-overlay")&&this.close(null)}onEscape(e){e.code==="Escape"&&this.close(null)}onMouseDown(e){e.matches(".d-overlay, .modal-dialog, .modal")&&!this.options.ismodal&&this.close(null)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=h({type:i,selectors:[["ct-dialog"]],hostBindings:function(t,o){t&1&&p("click",function(u){return o.onClick(u.target)})("keydown",function(u){return o.onEscape(u)},!1,K)("mousedown",function(u){return o.onMouseDown(u.target)})},outputs:{onClose:"onClose"},ngContentSelectors:ut,decls:8,vars:1,consts:[[1,"modal-overlay","d-overlay"],["role","dialog","aria-labelledby","dialogtitle","tabindex","-1",1,"modal"],[1,"modal-header"],["id","dialogtitle",1,"f6","modal-title"],["type","button",1,"modal-close",3,"click"],[1,"modal-body"]],template:function(t,o){t&1&&(z(),l(0,"div",0)(1,"div",1)(2,"div",2)(3,"h6",3),r(4),a(),l(5,"button",4),p("click",function(){return o.close()}),a()(),l(6,"div",5),J(7),a()()()),t&2&&(s(4),m(o.options==null?null:o.options.title))},dependencies:[b],encapsulation:2,changeDetection:0})};var R=class i{constructor(e,t){this.appRef=e;this.doc=t}dialogs={};open(e,t){let o=t?.providers?.length?G.create({providers:t.providers}):void 0,n=A(e,{environmentInjector:this.appRef.injector,elementInjector:o});this.appRef.attachView(n.hostView);let u=n.hostView.rootNodes,c=A(k,{environmentInjector:this.appRef.injector,projectableNodes:[u]}),D=c.hostView.rootNodes[0];t?.id&&(D.id=t.id,this.dialogs[t.id]=c.instance),t?.css&&D.classList.add(...t.css.split(" ")),this.doc.body.append(D),this.appRef.attachView(c.hostView),c.instance.options=F(B({},t),{ismodal:t?.ismodal||!1,title:t?.title||""}),n.instance.data=t?.data,n.instance.dialog=c.instance,n.instance.dialogElement=D;let pt=c.instance.onClose.subscribe(mt=>{t?.onclose&&t.onclose(mt),this.appRef.detachView(c.hostView),c.destroy(),this.appRef.detachView(n.hostView),n.destroy(),t?.id&&delete this.dialogs[t.id],pt.unsubscribe()});return n.instance}get(e){return this.dialogs[e]||null}static \u0275fac=function(t){return new(t||i)(v(W),v(Z))};static \u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"})};var T=class i{constructor(e){this._http=e}_changeUrl=f.API.vote.change;ChangeVote(e){let t=this._changeUrl.replace(":id",e);return this._http.post(t,{}).pipe(d(o=>o))}static \u0275fac=function(t){return new(t||i)(v(O))};static \u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"})};function _t(i,e){if(i&1){let t=U();l(0,"div",3)(1,"a",14),p("click",function(){M(t);let n=P(2);return L(n.vote())}),l(2,"i",15),r(3,"vote"),a()()()}}function Pt(i,e){if(i&1&&(r(0),S(1,"relativetime")),i&2){let t=P(2);y(" Created ",E(1,1,t.post.created)," | ")}}function bt(i,e){if(i&1&&(l(0,"div",16),r(1),a()),i&2){let t=P(2);s(),y(" ",t.post.excerpt," ")}}function Ct(i,e){if(i&1&&(l(0,"li",17)(1,"a",18),r(2),a()()),i&2){let t=e.$implicit;s(2),m(t.id)}}function It(i,e){if(i&1){let t=U();l(0,"div",0)(1,"div",1),Y(2),S(3,"async"),l(4,"div",2),r(5),a(),_(6,_t,4,0,"div",3),a(),l(7,"div",4)(8,"h5",5)(9,"a",6),r(10),a()(),l(11,"div",7),_(12,Pt,2,3),r(13),S(14,"relativetime"),a(),_(15,bt,2,1,"div",8),l(16,"div",3)(17,"i",9),r(18,"comment"),a(),r(19),a(),l(20,"div",10)(21,"ul",11),_(22,Ct,3,1,"li",12),a(),l(23,"div",13)(24,"i",9),r(25,"user"),a(),r(26,"\xA0"),l(27,"a",14),p("click",function(){M(t);let n=P();return L(n.openProfile(n.post.author.displayname,n.post.author.username))}),r(28),a()()()()()}if(i&2){let t=P(),o=E(3,12,t.votes$);s(5),y("+",o,""),s(),w(t.mode.full?6:-1),s(3),Q("routerLink","/posts/",t.post.id,""),s(),m(t.post.title),s(2),w(t.mode.full?12:-1),s(),y(" Last updated ",E(14,14,t.post.updated)," "),s(2),N("ngIf",!t.mode.full),s(4),X(" ",t.post.stats.comments," . ",t.post.status.value," "),s(3),N("ngForOf",t.post.tags),s(6),m(t.post.author.displayname)}}var ct=class i{constructor(e,t){this.dialog=e;this.voteSevrice=t}mode={full:!1};post;votes$=new $(0);ngOnInit(){this.votes$.next(this.post?.stats?.votes)}openProfile(e,t){this.dialog.open(j,{data:{name:e,id:t},css:"modal-bottom-sheet animate frombottom",title:e})}vote(){this.voteSevrice.ChangeVote(this.post.id).subscribe({next:e=>{this.votes$.next(e)}})}static \u0275fac=function(t){return new(t||i)(I(R),I(T))};static \u0275cmp=h({type:i,selectors:[["cl-post-card"]],inputs:{mode:"mode",post:"post"},decls:1,vars:1,consts:[[1,"grid","g-2"],[1,"vote","txt-c"],[1,"f4"],[1,"breath"],[1,"content"],[1,"f5"],[3,"routerLink"],[1,"weight-bold"],["class","light",4,"ngIf"],[1,"liga"],[1,"card"],[1,"row","row-gap"],["class","label label-grey-light",4,"ngFor","ngForOf"],[1,"tail"],[3,"click"],[1,"f4","liga"],[1,"light"],[1,"label","label-grey-light"],["routerLink","posts"]],template:function(t,o){t&1&&_(0,It,29,16,"div",0),t&2&&w(o.post?0:-1)},dependencies:[b,tt,et,it,V,nt,rt],encapsulation:2,changeDetection:0})};var dt=class i{constructor(e){this._http=e}_listUrl=f.API.post.list;_detailsUrl=f.API.post.details;_createUrl=f.API.post.create;_saveUrl=f.API.post.save;_deleteUrl=f.API.post.delete;GetPosts(e={}){let t=at(lt.MapSearchListOptions(e)),o=this._listUrl.replace(":options",t);return this._http.get(o).pipe(d(n=>C.NewList(n)))}GetPost(e){let t=this._detailsUrl.replace(":id",e);return this._http.get(t).pipe(d(o=>C.NewInstance(o)))}CreatePost(e){let t=this._createUrl,o=C.PrepCreate(e);return _debug(o,"CreatePost data"),this._http.post(t,o).pipe(d(n=>C.NewInstance(n)))}SavePost(e){let t=this._saveUrl.replace(":id",e.id),o=C.PrepSave(e);return _debug(o,"SavePost data"),this._http.put(t,o).pipe(d(n=>e))}DeletePost(e){let t=this._deleteUrl.replace(":id",e.id);return this._http.delete(t).pipe(d(o=>!0))}static \u0275fac=function(t){return new(t||i)(v(O))};static \u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"})};export{ct as a,dt as b};
