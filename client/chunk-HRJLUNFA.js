import{a as H}from"./chunk-6OUJ5KKQ.js";import{a as B,c as G,e as q}from"./chunk-EZ3FCO5Y.js";import{a as $}from"./chunk-BOMIEB5P.js";import{a as M}from"./chunk-RCT625XJ.js";import{$ as k,Ba as E,D as L,E as S,Ga as h,Ha as g,O as a,Q as m,R as y,Ra as T,Ta as j,Ua as F,W as O,Ya as R,ha as o,hb as A,i as p,ia as n,ma as b,na as _,oa as P,ob as U,qb as V,s as x,sa as D,vb as d,w as l,xa as r,ya as f,z as w}from"./chunk-2RYABZQO.js";var u=class e{static NewInstance(t){return{id:t.id,user:t.user?H.NewInstance(t.user):null,action:t.action,content:t.content,date:V(t.date),post:t.post?q.NewInstance(t.post):null}}static NewInstances(t){return t.map(e.NewInstance)}static NewList(t){let i=new G;return i.mapper=e.NewInstance,i.NewDataList(t)}};var I=class e{constructor(t){this._http=t}_listUrl=d.API.notification.list;_clearUrl=d.API.notification.clear;_deleteUrl=d.API.notification.delete;GetNotifications(t={}){return this._http.get(this._listUrl).pipe(p(i=>u.NewList(i)))}ClearNotification(){let t=this._clearUrl;return this._http.post(t,{action:"delete"}).pipe(p(i=>!0))}DeleteNotification(t){let i=this._deleteUrl.replace(":id",t.id);return this._http.delete(i).pipe(p(s=>!0))}static \u0275fac=function(i){return new(i||e)(w(R))};static \u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"})};var v=class e extends M{constructor(){super()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"})};function Q(e,t){if(e&1){let i=b();o(0,"li")(1,"div",7)(2,"div")(3,"i",8),r(4,"user"),n()(),o(5,"div",9)(6,"div")(7,"div",10),r(8),n(),o(9,"a",11),r(10),n(),o(11,"strong"),r(12,"Replied:"),n(),o(13,"div",12),r(14),h(15,"relativetime"),n()(),o(16,"div",13)(17,"i",14),_("click",function(){let c=L(i).$implicit,C=P();return S(C.delete(c))}),r(18,"trash"),n()()()()()}if(e&2){let i=t.$implicit;a(8),f(i.user.displayname),a(),D("routerLink","/posts/",i.post.id,""),a(),f(i.post.title),a(4),f(g(15,5,i.date))}}var N=class e{constructor(t,i,s){this.notificationService=t;this.toast=i;this.notificationListState=s}notifications$;ngOnInit(){this.notifications$=this.notificationService.GetNotifications().pipe(x(t=>this.notificationListState.SetList(t.matches)))}clear(){this.notificationService.ClearNotification().subscribe({next:()=>{this.notificationListState.emptyList(),this.toast.ShowSuccess("NOTIFICATIONS_CLEARED")}})}delete(t){this.notificationService.DeleteNotification(t).subscribe({next:()=>{this.notificationListState.removeItem(t)}})}static \u0275fac=function(i){return new(i||e)(m(I),m($),m(v))};static \u0275cmp=y({type:e,selectors:[["ng-component"]],decls:11,vars:3,consts:[[1,"page"],[1,"container"],[1,"f5","spaced"],[1,"rowlist"],[4,"ngFor","ngForOf"],[1,"txt-c"],[1,"btn",3,"click"],[1,"grid","g-1"],[1,"liga"],[1,"card"],[1,"small"],[1,"dblock","spaced",3,"routerLink"],[1,"smaller"],[1,"tail"],[1,"a","liga",3,"click"]],template:function(i,s){if(i&1){let c=b();o(0,"div",0)(1,"div",1),E(2),h(3,"async"),o(4,"h3",2),r(5,"Notifications"),n(),o(6,"ul",3),O(7,Q,19,7,"li",4),n(),o(8,"div",5)(9,"button",6),_("click",function(){return L(c),S(s.clear())}),r(10,"Clear all notifications"),n()()()()}if(i&2){let c=g(3,1,s.notifications$);a(7),k("ngForOf",c)}},dependencies:[F,T,j,U,A,B],encapsulation:2,changeDetection:0})};var _t=[{path:"",component:N}];export{_t as NotificationRoutes};
