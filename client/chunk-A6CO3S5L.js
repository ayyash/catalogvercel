import{a as K,b as A}from"./chunk-HBVKMVWM.js";import{a as bt}from"./chunk-6OUJ5KKQ.js";import{a as wt,c as Tt}from"./chunk-EZ3FCO5Y.js";import{a as vt,b as gt,c as Ct,d as It,e as _t,f as ht,g as Pt,h as St,i as yt,j as Lt,k as Ft}from"./chunk-HY2QN56R.js";import{a as xt}from"./chunk-BOMIEB5P.js";import{a as J}from"./chunk-RCT625XJ.js";import{$ as p,Aa as dt,Ba as P,Ca as k,D as T,Da as R,E,Ea as W,Fa as F,Ga as I,H as q,Ha as _,O as a,Q as g,R as c,Ra as V,Sa as S,Ta as y,Ua as d,W as u,Ya as ft,a as ot,da as st,ea as mt,fa as pt,ga as lt,ha as o,hb as z,i as O,ia as n,ja as l,ma as M,na as h,oa as v,ob as f,qb as ut,s as nt,sa as ct,vb as $,w as N,wa as rt,xa as s,z as at,za as b}from"./chunk-2RYABZQO.js";var Dt=()=>[1,2,3,4,5];function Ot(i,e){i&1&&(o(0,"span",6)(1,"i",7),s(2,"delete"),n()())}function Nt(i,e){if(i&1&&(o(0,"li")(1,"a",3),l(2,"div",4),s(3),u(4,Ot,3,0,"span",5),n()()),i&2){let t=e.$implicit,r=v();a(3),b(" file",t," "),a(),p("ngIf",r.mode.forEdit)}}function Mt(i,e){i&1&&(o(0,"li")(1,"a",3),l(2,"div",4),o(3,"i",7),s(4,"add"),n(),s(5," Add file "),n()())}var j=class i{mode={forEdit:!1};files=[];constructor(){}ngOnInit(){}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=c({type:i,selectors:[["cl-file-list"]],inputs:{mode:"mode",files:"files"},decls:3,vars:3,consts:[[1,"row","row-gap","umd-2","uc-5"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"dblock","box","box-white"],[1,"h-2","box","box-grey","spaced"],["class","lbreath",4,"ngIf"],[1,"lbreath"],[1,"liga"]],template:function(t,r){t&1&&(o(0,"ul",0),u(1,Nt,5,2,"li",1)(2,Mt,6,0,"li",2),n()),t&2&&(a(),p("ngForOf",F(2,Dt)),a(),p("ngIf",r.mode.forEdit))},dependencies:[d,V,S,f],encapsulation:2,changeDetection:0})};var G=class i extends J{constructor(){super("DEBUG")}static \u0275fac=function(t){return new(t||i)};static \u0275prov=N({token:i,factory:i.\u0275fac})};function Rt(i,e){if(i&1){let t=M();o(0,"li"),s(1),o(2,"i",4),h("click",function(){let m=T(t).$implicit,C=v();return E(C.remove(m))}),s(3,"cross"),n()()}if(i&2){let t=e.$implicit;a(),b("",t.id," ")}}var Q=class i{constructor(e){this.tagListState=e}tags=[];tags$;onTagChange=new q;ngOnInit(){this.tags$=this.tagListState.SetList(this.tags||[])}remove(e){this.tagListState.removeItem(e),this.onTagChange.emit(this.tagListState.currentList)}add(e){let t=e.target;this.tagListState.addItem({id:t.value}),this.onTagChange.emit(this.tagListState.currentList),t.value="",e.preventDefault()}static \u0275fac=function(t){return new(t||i)(g(G,8))};static \u0275cmp=c({type:i,selectors:[["cl-tag-list"]],inputs:{tags:"tags"},outputs:{onTagChange:"onTagChange"},features:[W([G])],decls:9,vars:3,consts:[[1,"row","row-gap"],[4,"ngFor","ngForOf"],[1,"liga"],["type","text","placeholder","Add new tag",1,"c-8","smaller",3,"keydown.enter"],[1,"liga","a",3,"click"]],template:function(t,r){if(t&1){let m=M();P(0),I(1,"async"),o(2,"ul",0),u(3,Rt,4,1,"li",1),o(4,"li")(5,"i",2),s(6,"add"),n(),s(7," \xA0"),o(8,"input",3),h("keydown.enter",function(w){return T(m),E(r.add(w))}),n()()()}if(t&2){let m=_(1,1,r.tags$);a(3),p("ngForOf",m)}},dependencies:[d,V,y,f],encapsulation:2,changeDetection:0})};var Vt=()=>({forEdit:!0}),U=class i{constructor(e,t){this.fb=e;this.toast=t}mode={forNew:!0};post;onSave=new q;postForm;ngOnInit(){this.postForm=this.fb.group({title:[],content:[],tags:[[]]}),this.post&&this.postForm.patchValue(this.post)}savePost(){if(this.toast.Hide(),this.postForm.valid){let e=this.postForm.value;this.post&&(e=ot(ot({},this.post),e)),this.onSave.emit(e)}else this.toast.ShowError("INVALID_FORM")}static \u0275fac=function(t){return new(t||i)(g(St),g(xt))};static \u0275cmp=c({type:i,selectors:[["cl-post-form"]],inputs:{mode:"mode",post:"post"},outputs:{onSave:"onSave"},decls:13,vars:6,consts:[["novalidate","",3,"ngSubmit","formGroup"],["placeholder","Title"],["type","text","id","title","crinput","","formControlName","title",1,"cr-input","w100",3,"required"],[3,"onTagChange","tags"],[1,"spaced"],["placeholder","Start writing..."],["id","content","formControlName","content","crinput","",1,"cr-input","w100","h-5",3,"required"],[1,"f5","spaced"],[3,"mode"],[1,"spacetop"],["type","submit",1,"btn-rev"]],template:function(t,r){t&1&&(o(0,"form",0),h("ngSubmit",function(){return r.savePost()}),o(1,"cr-input",1),l(2,"input",2),n(),o(3,"cl-tag-list",3),h("onTagChange",function(C){return r.postForm.controls.tags.setValue(C)}),n(),o(4,"div",4)(5,"cr-input",5),l(6,"textarea",6),n()(),o(7,"h5",7),s(8," Attachments "),n(),l(9,"cl-file-list",8),o(10,"div",9)(11,"button",10),s(12,"Save"),n()()()),t&2&&(p("formGroup",r.postForm),a(2),p("required",!0),a(),p("tags",r.post==null?null:r.post.tags),a(3),p("required",!0),a(3),p("mode",F(5,Vt)))},dependencies:[d,f,yt,It,vt,gt,Ct,Pt,_t,ht,Lt,Ft,Q,j],encapsulation:2,changeDetection:0})};var X=class i{id;constructor(){}ngOnInit(){}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=c({type:i,selectors:[["cl-post-create"]],inputs:{id:"id"},decls:3,vars:0,consts:[[1,"page"],[1,"container"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1),l(2,"cl-post-form"),n()())},dependencies:[d,f,U],encapsulation:2,changeDetection:0})};var B=class i extends J{constructor(){super()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=N({token:i,factory:i.\u0275fac})};var L=class i{static NewInstance(e){return{id:e.id,content:e.content,author:bt.NewInstance(e.author),created:ut(e.created),replies:e.replies}}static NewInstances(e){return e.map(i.NewInstance)}static NewList(e){let t=new Tt;return t.mapper=i.NewInstance,t.NewDataList(e)}static PrepCreate(e){return{content:e.content}}};var Y=class i{constructor(e){this._http=e}_listUrl=$.API.comment.list;_repliesUrl=$.API.comment.replies;_createUrl=$.API.comment.create;_replyUrl=$.API.comment.reply;_deleteUrl=$.API.comment.delete;GetComments(e){let t=this._listUrl.replace(":id",e);return this._http.get(t).pipe(O(r=>L.NewList(r)))}GetReplies(e,t){let r=this._repliesUrl.replace(":id",e).replace(":cid",t);return this._http.get(r).pipe(O(m=>L.NewInstances(m)))}CreateComment(e,t){let r=this._createUrl.replace(":id",t),m=L.PrepCreate(e);return _debug(m,"CreateComment data"),this._http.post(r,m).pipe(O(C=>L.NewInstance(C)))}CreateReply(e,t,r){let m=this._replyUrl.replace(":id",t).replace(":cid",r),C=L.PrepCreate(e);return _debug(C,"CreateReply data"),this._http.post(m,C).pipe(O(w=>L.NewInstance(w)))}DeleteComment(e){let t=this._deleteUrl.replace(":id",e.id);return this._http.delete(t).pipe(O(r=>!0))}static \u0275fac=function(t){return new(t||i)(at(ft))};static \u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})};function jt(i,e){if(i&1&&(o(0,"div",11),l(1,"cl-comment-list",12),n()),i&2){let t=v().$implicit,r=v();a(),p("id",r.id)("cid",t.id)}}function Gt(i,e){if(i&1){let t=M();o(0,"li")(1,"div",3)(2,"div")(3,"i",4),s(4,"user"),n()(),o(5,"div")(6,"span",7),s(7),I(8,"relativetime"),n(),o(9,"div",8)(10,"strong"),s(11,"Updated:"),n(),s(12),n(),o(13,"div",9),h("click",function(){T(t);let m=v();return E(m.showReplies=!0)}),o(14,"i",4),s(15,"comment"),n(),s(16),n(),u(17,jt,2,2,"div",10),n()()()}if(i&2){let t=e.$implicit,r=v();a(7),dt("",t.author==null?null:t.author.displayname," . ",_(8,5,t.created),""),a(5),b(" ",t.content," "),a(4),b(" ",t.replies,""),a(),p("ngIf",r.showReplies)}}var Z=class i{constructor(e,t){this.commentListState=e;this.commentService=t}id;cid;showReplies=!1;comments$;ngOnInit(){this.cid?this.comments$=this.commentService.GetReplies(this.id,this.cid).pipe(nt(e=>this.commentListState.SetList(e))):this.comments$=this.commentService.GetComments(this.id).pipe(nt(e=>this.commentListState.SetList(e.matches)))}add(e){this.cid?this.commentService.CreateReply({content:e.value},this.id,this.cid).subscribe({next:t=>{this.commentListState.addItem(t),e.value=""}}):this.commentService.CreateComment({content:e.value},this.id).subscribe({next:t=>{this.commentListState.addItem(t),e.value=""}})}static \u0275fac=function(t){return new(t||i)(g(B),g(Y))};static \u0275cmp=c({type:i,selectors:[["cl-comment-list"]],inputs:{id:"id",cid:"cid"},features:[W([B])],decls:15,vars:3,consts:[["comment",""],[1,"row-list"],[4,"ngFor","ngForOf"],[1,"grid","g-1"],[1,"liga"],["type","text","placeholder","Write a comment...",1,"cr-input","c-10",3,"keydown.enter"],[1,"liga",3,"click"],[1,"smaller"],[1,"breath"],[1,"spaced",3,"click"],["class","box",4,"ngIf"],[1,"box"],[3,"id","cid"]],template:function(t,r){if(t&1){let m=M();P(0),I(1,"async"),o(2,"ul",1),u(3,Gt,18,7,"li",2),o(4,"li")(5,"div",3)(6,"div")(7,"i",4),s(8,"user"),n()(),o(9,"div")(10,"input",5,0),h("keydown.enter",function(){T(m);let w=rt(11);return E(r.add(w))}),n(),s(12,"\xA0 "),o(13,"a",6),h("click",function(){T(m);let w=rt(11);return E(r.add(w))}),s(14,"send"),n()()()()()}if(t&2){let m=_(1,1,r.comments$);a(3),p("ngForOf",m)}},dependencies:[i,d,V,S,y,f,wt],encapsulation:2,changeDetection:0})};var Bt=()=>({full:!0});function Ht(i,e){i&1&&(o(0,"div"),s(1," This is a draft. "),n())}function qt(i,e){if(i&1&&(o(0,"div",2),u(1,Ht,2,0,"div",3),o(2,"div",4)(3,"a",5),s(4,"Edit"),n(),s(5," | Publish | Delete "),n()(),l(6,"cl-post-card",6),o(7,"div",7),s(8),n(),o(9,"div",7),l(10,"cl-file-list"),n(),l(11,"cl-comment-list",8)),i&2){v();let t=R(2);a(),p("ngIf",t.status.value==="DRAFT"),a(2),ct("routerLink","/posts/edit/",t.id,""),a(3),p("mode",F(7,Bt))("post",t),a(2),b(" ",t.content," "),a(3),p("id",t.id)}}var tt=class i{constructor(e){this.postService=e}id;post$;ngOnInit(){this.post$=this.postService.GetPost(this.id)}static \u0275fac=function(t){return new(t||i)(g(A))};static \u0275cmp=c({type:i,selectors:[["cl-post-details"]],inputs:{id:"id"},decls:5,vars:4,consts:[[1,"page"],[1,"container"],[1,"box","box-grey-light","card","spaced"],[4,"ngIf"],[1,"tail"],[3,"routerLink"],[1,"spaced","dblock",3,"mode","post"],[1,"spaced"],[3,"id"]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"div",1),P(2),I(3,"async"),u(4,qt,12,8),n()()),t&2){a(2);let m=k(_(3,1,r.post$));a(2),st(m?4:-1)}},dependencies:[d,S,y,f,z,K,Z,j],encapsulation:2,changeDetection:0})};var Wt=()=>({forEdit:!0});function zt(i,e){if(i&1&&l(0,"cl-post-form",3),i&2){v();let t=R(2);p("mode",F(2,Wt))("post",t)}}var et=class i{constructor(e){this.postService=e}id;post$;ngOnInit(){this.post$=this.postService.GetPost(this.id)}static \u0275fac=function(t){return new(t||i)(g(A))};static \u0275cmp=c({type:i,selectors:[["cl-post-edit"]],inputs:{id:"id"},decls:5,vars:4,consts:[[1,"page"],[1,"container"],[3,"mode","post",4,"ngIf"],[3,"mode","post"]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"div",1),P(2),I(3,"async"),u(4,zt,1,3,"cl-post-form",2),n()()),t&2){a(2);let m=k(_(3,1,r.post$));a(2),p("ngIf",m)}},dependencies:[d,S,y,f,U],encapsulation:2,changeDetection:0})};function Jt(i,e){if(i&1&&(o(0,"li"),l(1,"cl-post-card",6),n()),i&2){let t=e.$implicit;a(),p("post",t)}}function Kt(i,e){if(i&1&&(o(0,"ul",5),pt(1,Jt,2,1,"li",null,mt),n()),i&2){v();let t=R(2);a(),lt(t.matches)}}var it=class i{constructor(e){this.postService=e}posts$;ngOnInit(){this.posts$=this.postService.GetPosts()}static \u0275fac=function(t){return new(t||i)(g(A))};static \u0275cmp=c({type:i,selectors:[["cl-post"]],decls:8,vars:4,consts:[[1,"page"],[1,"container"],[1,"spaced"],["routerLink","/posts/create",1,"btn","btn-diff"],["class","rowlist",4,"ngIf"],[1,"rowlist"],[3,"post"]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"div",1),P(2),I(3,"async"),o(4,"div",2)(5,"button",3),s(6,"Create a new idea"),n()(),u(7,Kt,3,0,"ul",4),n()()),t&2){a(2);let m=k(_(3,1,r.posts$));a(5),p("ngIf",m==null?null:m.matches)}},dependencies:[d,S,y,f,z,K],encapsulation:2,changeDetection:0})};var Ci=[{path:"",component:it},{path:"create",component:X},{path:"edit/:id",component:et},{path:":id",component:tt}];export{Ci as PostRoutes};
